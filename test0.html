<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Analysis of the Iraq War</title>
<link rel="stylesheet" href="d3.slider.css" />
<!-- <link href="css/bootstrap.min.css" rel="stylesheet" media="screen"> -->
</head>

<style>
body {
      font-family: arial,sans-serif;
}
.boundary {
  fill: #fee8c8;
  stroke: #A8A8A8;
  stroke-width: 1px;
}
.tooltip {
  position: absolute;
  width: 150px;
  height: 60px;
  font: 15px rockwell;        
  background: lightgrey;   
  pointer-events: none;pointer-events: none;
}
</style>


<body>

</body>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="http://code.jquery.com/jquery.js"></script>
<!-- <script src="d3.slider.js"></script> -->


<script>
var margin = {top: 70, right: 5, bottom: 10, left: 5},
    width = window.innerWidth,
    height = window.innerHeight;

var projection = d3.geo.mercator()
    .center([37, 37.4])
    .scale(3000)
    .translate([0, 0])
    .precision(.1);

var path = d3.geo.path()
    .projection(projection);
 
var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var tooltip = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("opacity", 10);


d3.json("districts-geo.json", function(error, irq) {
  svg.selectAll(".districts")
      .data(topojson.feature(irq, irq.objects.districts).features)
      .enter().append("path")
      .attr("class", function(d) { return "district " + d.id; })
      .attr("d", path)
      .attr("class", "boundary")
      .on("mouseover", function(d) {
          tooltip.transition()
               .duration(200)
               .style("opacity", .8);
          tooltip.html(d["id"])
               .style("left", (d3.event.pageX + 5) + "px")
               .style("top", (d3.event.pageY - 28) + "px"); })
      .on("mouseout", function(d) {
          tooltip.transition()
               .duration(1000)
               .style("opacity", 0); })

//load cities data
d3.csv("cities.csv", function(error, cities) {
    cities.forEach(function(d) {
    d.lat = +d.lat;
    d.lon = +d.lon; });
var elemEnter = svg.selectAll("g")
    .data(cities)
    .enter().append("g")
    .attr("transform", function(d){return "translate(" + projection([d.lon, d.lat]) + ")"});
var circle = elemEnter.append("circle")
    .attr("r", 3 )
    .attr("stroke","black")
    .attr("fill", "black");
elemEnter.append("text")
    .attr("dx", 5) 
    .attr("y", function(d){ if (d.city=='Ramadi') {return -10} if (d.city=='Mosul') {return -10} if (d.city=='Fallujah') {return 20} else {return 10} }) 
    .attr("x", function(d){ if (d.city=='Ramadi') {return -50} if (d.city=='Fallujah') {return -40} else {return 0} }) 
    .text(function(d){return d.city}) });  
   

});
  


</script>
